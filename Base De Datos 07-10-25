
SELECT TO_NUMBER ('123') FROM DUAL;
SELECT TO_CHAR ('123') FROM DUAL;

SELECT LAST_NAME, COMMISSION_PCT AS "COMISION"
FROM HR.EMPLOYEES
WHERE DEPARTMENT_ID IN (80,90);

SELECT LAST_NAME, NVL(COMMISSION_PCT, 0) AS "COMISION FINAL"
FROM HR.EMPLOYEES
WHERE DEPARTMENT_ID IN (80,90);

--Expresiones condicionales (CASE, DECODE)
--(CASE)
SELECT LAST_NAME, DEPARTMENT_ID AS "DEPARTAMENTO" FROM HR.EMPLOYEES,

    SELECT LAST_NAME,
    CASE DEPARTMENT_ID
    WHEN 90 THEN 'ADMINISTRADOR'
    WHEN 80 THEN 'VENTAS'
    WHEN 60 THEN 'I.T.'
    ELSE 'OTRO DEPARTAMENTO'
    END
    AS "DEPARTAMENTO"
    FROM HR.EMPLOYEE;
    
    SELECT LAST_NAME, JOB_ID, SALARY,
    CASE JOB_ID WHEN 'it_prog' THEN 1.10*SALARY
                WHEN 'st_clerk' THEN 1.15*SALARY
                WHEN 'sa_rep' THEN 1.20*SALARY
    ELSE SALARY END AS "SALARIO REVISADO"
    FROM HR.EMPLOYEES;
    
--(DECODE)
    SELECT LAST_NAME,
    DECODE (DEPARTMENT_ID,
    90, 'ADMINISTRADOR',
    80, 'VENTAS',
    60, 'I.T.',
    'OTRO DEPARTAMENTO')
    FROM HR.EMPLOYEES
    
--AGRUPACIONES
    --(GROUP BY)
        SELECT department_id, AVG(salary)
        FROM hr.employees
        GROUP BY department_id;
        
        SELECT job_id, COUNT(job_id)
        FROM hr.employees
        GROUP BY job_id;
        
        SELECT job_id, AVG(min_salary)
        FROM hr.jobs
        GROUP BY job_id;
    --(HAVING)
        SELECT DEPARTMENT_ID, ROUND(AVG(SALARY))
        FROM HR.EMPLOYEES
        GROUP BY DEPARTMENT_ID
        HAVING AVG(SALARY) >5000;
        
        SELECT JOB_ID, COUNT(JOB_ID)
        FROM HR.EMPLOYEES
        GROUP BY JOB_ID
        HAVING JOB_ID IN ('AD_VP','IT_PROG')
        
        SELECT JOB_ID, round(AVG(MIN_SALARY))
        FROM HR.JOBS
        GROUP BY JOB_ID
        HAVING AVG(MIN_SALARY) >6000;

