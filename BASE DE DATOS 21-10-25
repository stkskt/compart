SELECT * FROM HR.EMPLOYEES;


--"FUNCIONES NUMERICAS"
SELECT LAST_NAME, 
ROUND (SALARY / COMMISSION_PCT,2) "SALARIO REDONDEADO",
TRUNC (SALARY/ COMMISSION_PCT,1) "SALARIO TRUNCADO", SALARY,
MOD (SALARY,110) "RESTO DE DIVISIÓN"
FROM HR.EMPLOYEES
WHERE LAST_NAME IN ('Smith','Sullv');

--"FUNCIONES DE FECHA"

SELECT SYSDATE FROM DUAL; --MUESTRA FECHA ACTUAL

SELECT ADD_MONTHS (SYSDATE,4) "HOY + 4 MESES" FROM DUAL;
SELECT ADD_MONTHS (SYSDATE,-3) "HOY - 3 MESES" FROM DUAL;
SELECT (SYSDATE -5) FROM DUAL;

SELECT NEXT_DAY (SYSDATE, 'Lunes') LUNES FROM DUAL;
SELECT LAST_DAY (SYSDATE) FROM DUAL;

SELECT MONTHS_BETWEEN (SYSDATE, TO_DATE('15-01-1980','DD-MM-YYYY')) FROM DUAL; --MUESTRA EDAD EN MESES
SELECT MONTHS_BETWEEN (SYSDATE, TO_DATE('19-07-2004','DD-MM-YYYY')) FROM DUAL; --MUESTRA EDAD EN MESES
SELECT ROUND(MONTHS_BETWEEN (SYSDATE, TO_DATE('19-07-2004','DD-MM-YYYY'))/12,0) FROM DUAL; --MUESTRA EDAD

SELECT TO_CHAR(SYSDATE,'Day-dd-Month-Year') FROM DUAL; --DAR FORMATO
SELECT TO_CHAR(SYSDATE,'YYYY-MM-DD') FROM DUAL; --DAR FORMATO

SELECT EXTRACT (DAY FROM SYSDATE) FROM DUAL; -- MUESTRA EL DIA ACTUAL DEL MES
SELECT EXTRACT (MONTH FROM SYSDATE) FROM DUAL; -- MUESTRA EL MES ACTUAL DEL AÑO
SELECT EXTRACT (YEAR FROM SYSDATE) FROM DUAL; -- MUESTRA EL AÑO ACTUAL

--"AGRUPAR"
SELECT JOB_ID, COUNT(JOB_ID)
FROM HR.EMPLOYEES
GROUP BY JOB_ID
HAVING COUNT(JOB_ID) > 5;

SELECT JOB_ID, AVG(SALARY)
FROM HR.EMPLOYEES
GROUP BY JOB_ID
HAVING AVG(SALARY) > 6000
ORDER BY 2;

--"NVL - NULL VALUE"
SELECT LAST_NAME, NVL(COMMISSION_PCT,1) FROM HR.EMPLOYEES; --ESTADO NULO DE UN VALOR REEMPLAZADO

--"JOIN (INNER JOIN, RIGHT JOIN, LEFT JOIN, FULL OUTER JOIN)"
SELECT LAST_NAME, DEPARTMENT_NAME, JOB_TITLE
FROM HR.EMPLOYEES E -- TABLA IZQUIERDA
INNER JOIN HR.DEPARTMENTS D -- TABLA DERECHA
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
INNER JOIN HR.JOBS J
    ON E.JOB_ID = J.JOB_ID;

SELECT LAST_NAME, DEPARTMENT_NAME
FROM HR.EMPLOYEES E
RIGHT JOIN HR.DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;
    
SELECT LAST_NAME, DEPARTMENT_NAME
FROM HR.EMPLOYEES E
LEFT JOIN HR.DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;


SELECT LAST_NAME, DEPARTMENT_NAME
FROM HR.EMPLOYEES E
FULL OUTER JOIN HR.DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;
    
--"SUBCONSULTA"
    --"EJEMPLO: QUE ESTUDIANTES NACIERON EL MISMO MES QUE BENJAMIN"
    SELECT * FROM ESTUDIANTES WHERE;
    --"QUE EMPLEADOS GANAN MAS QUE EL SALARIO PROMEDIO"
    SELECT ROUND (AVG(SALARY),1) FROM HR.EMPLOYEES
    SELECT * FROM HR.EMPLOYEES WHERE SALARY > (SELECT ROUND(AVG(SALARY),1) FROM HR.EMPLOYEES) ORDER BY SALARY ASC;
    --"QUE EMPLEADOS GANAN EL MINIMO DEL SALARIO"
    SELECT * FROM HR.EMPLOYEES WHERE SALARY = (SELECT ROUND(MIN(SALARY),1) FROM HR.EMPLOYEES) ORDER BY SALARY ASC;
    
    SELECT * FROM HR.EMPLOYEES WHERE SALARY = (SELECT SALARY FROM HR.EMPLOYEES WHERE EMPLOYEE_ID = 123)

-- ACTIVIDADES
SELECT EMPLOYEE_ID, LAST_NAME, JOB_ID, SALARY
FROM HR.EMPLOYEES
WHERE SALARY < ANY
    (SELECT SALARY
     FROM HR.EMPLOYEES
     WHERE JOB_ID = 'IT_PROG')
